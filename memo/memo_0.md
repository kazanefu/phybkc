# 不足している設計情報概要

`design.md` を読み、現在のコードベースを確認した結果、以下の設計情報が不足していると判断しました。

## 1. 物理キーの識別方法 (Physical Key Mapping)
- **現状**: 「物理キーの位置に基づいて設定できる」とあるが、その識別子（ScanCode、HID usage ID、または独自の座標系）が未定義。
- **必要情報**: OS（Windows）から取得できるどの情報を物理キーの ID として採用するか。

## 2. プロファイル設定ファイルのスキーマ
- **現状**: JSON または TOML を想定しているが、具体的な構造が未定義。
- **必要情報**: 
    - 物理キー ID と仮想キーの対応付け。
    - メタデータ（プロファイル名、対象アプリケーションなど）。
    - 読み込むスクリプトのパス。

## 3. スクリプトエンジンの仕様
- **現状**: 「専用スクリプトを用意」「AutoHotkeyのようなスクリプトエンジン」とあるが、構文と機能が未定義。
- **必要情報**:
    - スクリプトの構文（BNFなど）。
    - 利用可能なアクション（`press`, `release`, `tap`, `wait`, `run_command` 等）。
    - 物理位置指定とキー名指定の共存方法。

## 4. デーモンと GUI/CLI 間の通信 (IPC)
- **現状**: デーモンが常駐し、GUI で設定を行うが、その間の連携方法が未定義。
- **必要情報**: 通信プロトコル（Named Pipes, TCP, gRPC, 共有メモリ等）。

## 5. OS フックの具体的な実装方針
- **現状**: 「低レベルキーフック」とあるが、具体的な API が未定義。
- **必要情報**: `SetWindowsHookEx` (WH_KEYBOARD_LL) を使用するか、Raw Input 等の別の手法を検討するか。

## 6. キーボードレイアウトの考慮
- **現状**: GUI でレイアウトを表示するとあるが、異なるレイアウト（ISO, ANSI, JIS）への対応方法が未定義。
- **必要情報**: レイアウト定義データの形式と、物理位置との紐付けルール。

## 7. タスクトレイ UI の詳細
- **現状**: 「表示し、さらにプロファイル切り替えもできるようにしたい」とあるが、メニュー構成が未定義。
- **必要情報**: 右クリックメニューの項目、左クリック時の挙動、通知のタイミング。
